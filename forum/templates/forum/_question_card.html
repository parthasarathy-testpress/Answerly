{% load humanize vote_tags %}
<div class="card shadow-sm border-1 rounded-3 h-100" 
     style="transition: transform 0.2s, box-shadow 0.2s;"
     onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 15px rgba(0,0,0,0.15)';"
     onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='';">
  <div class="card-body d-flex justify-content-between align-items-start">
    <div>
      <h5 class="card-title fw-semibold mb-2" style="color: #077bceff;">
        {{ question.title }}
      </h5>
      <p class="mb-2">
        {% for tag in question.tags.all %}
          <span class="badge rounded-pill text-white" style="background-color: #7b848cff;">{{ tag.name }}</span>
        {% empty %}
          <span class="text-muted">No tags</span>
        {% endfor %}
      </p>
    </div>

    <div class="text-end">
      <p class="mb-1 text-muted small">Asked {{ question.created_at|naturaltime }}</p>
      {% if request.user.is_authenticated and request.user == question.author %}
        <div class="d-flex align-items-center gap-3">
          <a href="{% url 'question_edit' question.pk %}" class="text-primary fs-5" title="Edit Question">
            <i class="bi bi-pencil-square"></i>
          </a>
          <a href="{% url 'question_delete' question.pk %}" class="text-danger fs-5" title="Delete Question">
            <i class="bi bi-trash"></i>
          </a>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="card-footer bg-transparent border-0 text-muted small
              d-flex justify-content-between align-items-center">

    <div class="d-flex flex-column align-items-start me-auto"
         data-vote-group="question-{{ question.id }}">

      {% if request.user.is_authenticated %}
        {% get_user_vote question request.user as user_vote %}
      {% else %}
        {% with 0 as user_vote %}{% endwith %}
      {% endif %}

      <div class="d-flex gap-2 align-items-center mb-1">
          {% if request.user.is_authenticated %}
            <button
              class="btn btn-sm vote-btn {% if user_vote|default:0 == 1 %}btn-success text-white{% else %}btn-outline-success{% endif %}"
              data-type="1"
              data-url="{% url 'vote_question' question.id %}"
              data-vote-type="1"
              @click.prevent.stop="vote($event)"
            >
              <i class="bi bi-hand-thumbs-up"></i>
              (<span data-upvote-count>{{ question.upvotes }}</span>)
            </button>

            <button
              class="btn btn-sm vote-btn {% if user_vote|default:0 == -1 %}btn-danger text-white{% else %}btn-outline-danger{% endif %}"
              data-type="-1"
              data-url="{% url 'vote_question' question.id %}"
              data-vote-type="-1"
              @click.prevent.stop="vote($event)"
            >
              <i class="bi bi-hand-thumbs-down"></i>
              (<span data-downvote-count>{{ question.downvotes }}</span>)
            </button>
          {% else %}
            <a href="{% url 'login' %}" class="btn btn-sm btn-outline-success">
              <i class="bi bi-hand-thumbs-up"></i>
              (<span>{{ question.upvotes }}</span>)
            </a>
            <a href="{% url 'login' %}" class="btn btn-sm btn-outline-danger">
              <i class="bi bi-hand-thumbs-down"></i>
              (<span>{{ question.downvotes }}</span>)
            </a>
          {% endif %}
      </div>
    </div>
    <div>
      Posted by <span class="fw-medium">{{ question.author.username }}</span>
    </div>

  </div>
</div>
